import nex
import helper
ne_file = helper.search_for_file_path(titles="Upload the NeuroExplorer file you want to analyze.\n")[0]
video_file = video_file = (ne_file[0:-5] + ".mp4").replace('neuroexplorer', 'videos')

try:
        doc = nex.OpenDocument(ne_file)
except:
        print(ne_file)
        print("Do you have NeuroExplorer open? If yes, NE document doesn't exist. Check to make sure the file is in the correct location.")
lickTimes = [5.645133333333333, 5.7152666666666665, 5.795433333333333, 5.885633333333334, 5.995866666666666, 6.126133333333334, 6.2464, 6.7675, 6.8777333333333335, 6.957933333333333, 7.0481, 7.1483, 7.258533333333333, 7.398866666666667, 7.5191, 10.275033333333333, 10.3652, 10.445366666666667, 10.555633333333333, 10.6458, 10.7761, 10.896366666666667, 12.579933333333333, 12.650066666666667, 12.7503, 12.8405, 12.960733333333334, 13.081, 13.2113, 14.965066666666667, 15.055266666666666, 15.135433333333333, 15.2557, 15.365933333333333, 33.2106, 33.3108, 33.411033333333336, 33.491166666666665, 33.61143333333333, 33.7217, 33.86196666666667, 42.5206, 42.630833333333335, 42.711, 42.7912, 42.8914, 43.001666666666665, 43.101866666666666, 43.2121, 43.34236666666666, 51.49986666666667, 51.58, 51.690266666666666, 51.8005, 61.6948, 61.754933333333334, 61.8351, 61.94533333333333, 62.03553333333333, 66.99613333333333, 67.08633333333333, 67.1665, 67.24666666666667, 67.3569, 67.46713333333334, 67.5874, 70.97466666666666, 71.07486666666667, 71.2553, 71.38553333333333, 71.5058, 71.63606666666666, 72.1171, 72.18726666666667, 72.37766666666667, 72.4979, 75.68473333333333, 75.97533333333334, 76.07556666666666, 76.17576666666666, 76.276, 76.38623333333334, 76.49646666666666, 76.62673333333333, 76.71693333333333, 76.86726666666667, 80.37476666666667, 80.4449, 80.54513333333334, 80.64536666666666, 80.74556666666666, 80.86583333333333, 80.97606666666667, 81.2266, 81.57736666666666, 81.69763333333333, 81.7778, 81.878, 81.98823333333333, 82.12853333333334, 82.23876666666666, 82.33896666666666, 82.4793, 82.60953333333333, 81.2266, 81.47716666666666, 81.58736666666667, 81.67756666666666, 81.7778, 81.878, 81.9782, 82.1085, 82.22873333333334, 82.35903333333333, 82.4793, 82.60953333333333, 85.45563333333334, 86.0469, 86.4277, 86.52793333333334, 86.65823333333333, 86.7484, 86.85863333333333, 103.3442, 103.41436666666667, 103.49456666666667, 103.5747, 103.6749, 103.8052, 103.92546666666667, 107.18233333333333, 107.23246666666667, 107.33266666666667, 107.43286666666667, 107.55313333333334, 107.66336666666666, 107.78363333333333, 109.88816666666666, 109.97836666666667, 110.0786, 110.16876666666667, 110.28903333333334, 110.4093, 110.52956666666667, 110.66986666666666, 115.44003333333333, 115.53023333333333, 115.63043333333333, 115.73066666666666, 115.84086666666667, 115.97116666666666, 116.08143333333334, 116.19163333333333, 116.34196666666666, 116.44216666666667, 116.9633, 117.02343333333333, 117.11366666666666, 117.21386666666666, 117.3241, 117.43433333333333, 117.57463333333334, 117.68486666666666, 117.7851, 125.30113333333334, 125.702, 125.7521, 125.83226666666667, 125.9325, 126.0327, 126.16296666666666, 126.28326666666666, 126.39346666666667, 126.51373333333333]
lickTimes.sort()
doc["lickTimes"] = nex.NewEvent(doc, 0)
doc["lickTimes"].SetTimestamps(lickTimes)
nex.SaveDocument(doc)
nex.CloseDocument(doc)